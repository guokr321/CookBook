"""
    Batch machines
"""
import os,sys

machines = (
        "192.168.2.90","192.168.2.91",
"192.168.2.86","192.168.2.84","192.168.2.88",
"192.168.2.102","192.168.2.52","192.168.2.49",
"192.168.2.47","192.168.2.95","192.168.2.98"  , 
"192.168.2.62","192.168.2.63","192.168.2.65",
"192.168.2.67",  "192.168.2.68","192.168.2.70",         
"192.168.2.73" , "192.168.2.74","192.168.2.75",   
"192.168.2.76", "192.168.2.77", "192.168.2.78",       
"192.168.2.79" , "192.168.2.80", "192.168.2.81" ,)  

machinesall= (
"192.168.2.95","192.168.2.98"  , 
"192.168.2.62","192.168.2.63","192.168.2.65",
"192.168.2.67",  "192.168.2.68","192.168.2.70",         
"192.168.2.73" , "192.168.2.74","192.168.2.75",   
"192.168.2.76", "192.168.2.77", "192.168.2.78",       
"192.168.2.79" , "192.168.2.80", "192.168.2.81" ,)
        
username = "hadoop"
password = " "


def main():
    flag = sys.argv[1]    
    for ips in machines:
        if flag == "scp":
            src = sys.argv[2]
            dest = sys.argv[3]
            os.system(" scp -r %s %s@%s:%s"%(src,username,ips,dest))
        elif flag == "ssh":
            cmd = sys.argv[2]
            os.system(" ssh -t  %s@%s %s "%(username,ips,cmd))
        print "*_* Finish task in " + ips 
    print "Cong! *_* Finish all!"

if __name__ == "__main__":
    main()
